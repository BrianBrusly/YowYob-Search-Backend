# ============================================
# BOOTSTRAP CONFIGURATION
# ============================================
# Chargé AVANT application.yml
# Utile pour Spring Cloud Config, Vault, etc.
# ============================================

spring:
  application:
    name: yowyob-api-gateway

  # Configuration Cloud pour le bootstrap
  cloud:
    # Spring Cloud Config (désactivé par défaut)
    config:
      enabled: ${CONFIG_SERVER_ENABLED:false}
      uri: ${CONFIG_SERVER_URI:http://localhost:8888}
      fail-fast: ${CONFIG_FAIL_FAST:false}
      retry:
        initial-interval: 1000
        max-attempts: 6
        max-interval: 2000
        multiplier: 1.1
      name: ${spring.application.name}
      profile: ${spring.profiles.active}

    # Vault pour les secrets (désactivé par défaut)
    vault:
      enabled: ${VAULT_ENABLED:false}
      host: ${VAULT_HOST:localhost}
      port: ${VAULT_PORT:8200}
      scheme: ${VAULT_SCHEME:http}
      authentication: ${VAULT_AUTH:token}
      token: ${VAULT_TOKEN:}
      kv:
        enabled: true
        backend: secret
        default-context: ${spring.application.name}
        profile-separator: '/'
        application-name: ${spring.application.name}

  # Profil par défaut
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  # Configuration des fichiers de propriétés
  config:
    import:
      - optional:file:.env[.properties]
      - optional:file:config/application-${spring.profiles.active}.properties

# Configuration du bootstrap logger
logging:
  level:
    org.springframework.cloud.bootstrap: INFO
    org.springframework.cloud.config: DEBUG